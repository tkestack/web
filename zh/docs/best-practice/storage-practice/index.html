<!doctype html><html lang=zh class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.83.1"><meta name=ROBOTS content="NOINDEX, NOFOLLOW"><link rel="shortcut icon" href=/web/favicons/favicon.ico><link rel=apple-touch-icon href=/web/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/web/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/web/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/web/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/web/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/web/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/web/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/web/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/web/favicons/android-192x192.png sizes=192x192><title>使用存储的实践 | Tkestack</title><meta name=description content="生产级别多集群管理系统"><meta property="og:title" content="使用存储的实践"><meta property="og:description" content="使用存储的实践
"><meta property="og:type" content="article"><meta property="og:url" content="/web/zh/docs/best-practice/storage-practice/"><meta property="article:section" content="docs"><meta property="article:modified_time" content="2022-03-25T12:02:21+08:00"><meta property="og:site_name" content="Tkestack"><meta itemprop=name content="使用存储的实践"><meta itemprop=description content="使用存储的实践
"><meta itemprop=dateModified content="2022-03-25T12:02:21+08:00"><meta itemprop=wordCount content="1321"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="使用存储的实践"><meta name=twitter:description content="使用存储的实践
"><link rel=preload href=/web/scss/main.min.f3f5e11928ea652eef8f11ab959efa477bbd1a85923ff5e0245c83fe74bd312a.css as=style><link href=/web/scss/main.min.f3f5e11928ea652eef8f11ab959efa477bbd1a85923ff5e0245c83fe74bd312a.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.5.1.min.js integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin=anonymous></script></head><body class=td-page><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar"><a class=navbar-brand href=/web/zh/><span class=navbar-logo></span><span class="text-uppercase font-weight-bold">Tkestack</span></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/web/zh/docs/><span>Docs</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/web/zh/blog/><span>Blog</span></a></li><li class="nav-item dropdown d-none d-lg-block"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>中文 Chinese</a><div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=/web/>English</a></div></li></ul></div><div class="navbar-nav d-none d-lg-block"></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><div id=td-sidebar-menu class=td-sidebar__inner><form class="td-sidebar__search d-flex align-items-center"><button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type=button data-toggle=collapse data-target=#td-section-nav aria-controls=td-docs-nav aria-expanded=false aria-label="Toggle section navigation"></button></form><nav class="collapse td-sidebar-nav" id=td-section-nav><div class="nav-item dropdown d-block d-lg-none"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>中文 Chinese</a><div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=/web/>English</a></div></div><ul class="td-sidebar-nav__section pr-md-3 ul-0"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-webzhdocs-li><a href=/web/zh/docs/ title="TKEStack 文档" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section tree-root" id=m-webzhdocs><span>文档</span></a><ul class="pr-md-3 ul-1"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsoverview-li><a href=/web/zh/docs/overview/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id=m-webzhdocsoverview><span>简介</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-webzhdocsinstallation-li><a href=/web/zh/docs/installation/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id=m-webzhdocsinstallation><span>部署</span></a><ul class="pr-md-3 ul-2"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsinstallationinstallation-architecture-li><a href=/web/zh/docs/installation/installation-architecture/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsinstallationinstallation-architecture><span>产品部署架构</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsinstallationenvironment-requirement-li><a href=/web/zh/docs/installation/environment-requirement/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsinstallationenvironment-requirement><span>部署环境要求</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsinstallationinstall-gpu-manager-li><a href=/web/zh/docs/installation/install-gpu-manager/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsinstallationinstall-gpu-manager><span>安装使用 GPU</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsinstallationmigration-steps-li><a href=/web/zh/docs/installation/migration-steps/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsinstallationmigration-steps><span>迁移步骤</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsinstallationinstallation-steps-li><a href=/web/zh/docs/installation/installation-steps/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsinstallationinstallation-steps><span>安装步骤</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsinstallationimagesreadme-li><a href=/web/zh/docs/installation/images/readme/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsinstallationimagesreadme><span></span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-webzhdocsquick-start-li><a href=/web/zh/docs/quick-start/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id=m-webzhdocsquick-start><span>快速入门</span></a><ul class="pr-md-3 ul-2"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsquick-startquick-starts-li><a href=/web/zh/docs/quick-start/quick-starts/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsquick-startquick-starts><span>快速入门</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-webzhdocsquick-startexample-li><a href=/web/zh/docs/quick-start/example/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id=m-webzhdocsquick-startexample><span>入门示例</span></a><ul class="pr-md-3 ul-3"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsquick-startexamplenginx-example-li><a href=/web/zh/docs/quick-start/example/nginx-example/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsquick-startexamplenginx-example><span>创建nginx服务</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsquick-startexamplehelloword-example-li><a href=/web/zh/docs/quick-start/example/helloword-example/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsquick-startexamplehelloword-example><span>编写HelloWorld程序</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsquick-startexampledocker-image-example-li><a href=/web/zh/docs/quick-start/example/docker-image-example/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsquick-startexampledocker-image-example><span>如何构建Docker镜像</span></a></li></ul></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-webzhdocsuser-guide-li><a href=/web/zh/docs/user-guide/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id=m-webzhdocsuser-guide><span>产品使用指南</span></a><ul class="pr-md-3 ul-2"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsuser-guideconsole-switch-li><a href=/web/zh/docs/user-guide/console-switch/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsuser-guideconsole-switch><span>切换控制台</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-webzhdocsuser-guideplatform-console-li><a href=/web/zh/docs/user-guide/platform-console/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id=m-webzhdocsuser-guideplatform-console><span>平台管理控制台</span></a><ul class="pr-md-3 ul-3"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsuser-guideplatform-consoleoverview-li><a href=/web/zh/docs/user-guide/platform-console/overview/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsuser-guideplatform-consoleoverview><span>概览</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsuser-guideplatform-consolecluster-mgmt-li><a href=/web/zh/docs/user-guide/platform-console/cluster-mgmt/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsuser-guideplatform-consolecluster-mgmt><span>集群管理</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsuser-guideplatform-consolebusiness-mgmt-li><a href=/web/zh/docs/user-guide/platform-console/business-mgmt/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsuser-guideplatform-consolebusiness-mgmt><span>业务管理</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-webzhdocsuser-guideplatform-consoleaddon-mgmt-li><a href=/web/zh/docs/user-guide/platform-console/addon-mgmt/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id=m-webzhdocsuser-guideplatform-consoleaddon-mgmt><span>扩展组件</span></a><ul class="pr-md-3 ul-4"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsuser-guideplatform-consoleaddon-mgmttappcontroller-li><a href=/web/zh/docs/user-guide/platform-console/addon-mgmt/tappcontroller/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsuser-guideplatform-consoleaddon-mgmttappcontroller><span>TApp 介绍</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsuser-guideplatform-consoleaddon-mgmtcronhpa-li><a href=/web/zh/docs/user-guide/platform-console/addon-mgmt/cronhpa/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsuser-guideplatform-consoleaddon-mgmtcronhpa><span>CronHPA 介绍</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsuser-guideplatform-consoleaddon-mgmtprometheus-li><a href=/web/zh/docs/user-guide/platform-console/addon-mgmt/prometheus/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsuser-guideplatform-consoleaddon-mgmtprometheus><span>监控组件</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsuser-guideplatform-consoleaddon-mgmtlogagent-li><a href=/web/zh/docs/user-guide/platform-console/addon-mgmt/logagent/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsuser-guideplatform-consoleaddon-mgmtlogagent><span>LogAgent 介绍</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsuser-guideplatform-consoleaddon-mgmtgpumanger-li><a href=/web/zh/docs/user-guide/platform-console/addon-mgmt/gpumanger/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsuser-guideplatform-consoleaddon-mgmtgpumanger><span>GPUManager 介绍</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsuser-guideplatform-consoleaddon-mgmtcsioperator-li><a href=/web/zh/docs/user-guide/platform-console/addon-mgmt/csioperator/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsuser-guideplatform-consoleaddon-mgmtcsioperator><span>CSIOperator 介绍</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-webzhdocsuser-guideplatform-consoleregistry-mgmt-li><a href=/web/zh/docs/user-guide/platform-console/registry-mgmt/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id=m-webzhdocsuser-guideplatform-consoleregistry-mgmt><span>组织资源</span></a><ul class="pr-md-3 ul-4"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsuser-guideplatform-consoleregistry-mgmtregistry-li><a href=/web/zh/docs/user-guide/platform-console/registry-mgmt/registry/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsuser-guideplatform-consoleregistry-mgmtregistry><span>镜像仓库管理</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsuser-guideplatform-consoleregistry-mgmthelm-repo-li><a href=/web/zh/docs/user-guide/platform-console/registry-mgmt/helm-repo/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsuser-guideplatform-consoleregistry-mgmthelm-repo><span>Helm模板</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsuser-guideplatform-consoleregistry-mgmtapikey-li><a href=/web/zh/docs/user-guide/platform-console/registry-mgmt/apikey/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsuser-guideplatform-consoleregistry-mgmtapikey><span>访问凭证</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-webzhdocsuser-guideplatform-consoleaccess-mgmt-li><a href=/web/zh/docs/user-guide/platform-console/access-mgmt/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id=m-webzhdocsuser-guideplatform-consoleaccess-mgmt><span>访问管理</span></a><ul class="pr-md-3 ul-4"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsuser-guideplatform-consoleaccess-mgmtpolicy-li><a href=/web/zh/docs/user-guide/platform-console/access-mgmt/policy/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsuser-guideplatform-consoleaccess-mgmtpolicy><span>策略管理</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsuser-guideplatform-consoleaccess-mgmtuser-li><a href=/web/zh/docs/user-guide/platform-console/access-mgmt/user/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsuser-guideplatform-consoleaccess-mgmtuser><span>用户管理</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-webzhdocsuser-guideplatform-consolemonitor-alert-li><a href=/web/zh/docs/user-guide/platform-console/monitor-alert/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id=m-webzhdocsuser-guideplatform-consolemonitor-alert><span>监控&告警</span></a><ul class="pr-md-3 ul-4"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsuser-guideplatform-consolemonitor-alertalertmetrics-li><a href=/web/zh/docs/user-guide/platform-console/monitor-alert/alertmetrics/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsuser-guideplatform-consolemonitor-alertalertmetrics><span>告警记录</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsuser-guideplatform-consolemonitor-alertnotification-li><a href=/web/zh/docs/user-guide/platform-console/monitor-alert/notification/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsuser-guideplatform-consolemonitor-alertnotification><span>通知设置</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsuser-guideplatform-consolemonitor-alertalertsetting-li><a href=/web/zh/docs/user-guide/platform-console/monitor-alert/alertsetting/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsuser-guideplatform-consolemonitor-alertalertsetting><span>告警设置</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-webzhdocsuser-guideplatform-consoleoperation-mgmt-li><a href=/web/zh/docs/user-guide/platform-console/operation-mgmt/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id=m-webzhdocsuser-guideplatform-consoleoperation-mgmt><span>运维中心</span></a><ul class="pr-md-3 ul-4"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsuser-guideplatform-consoleoperation-mgmthelm-li><a href=/web/zh/docs/user-guide/platform-console/operation-mgmt/helm/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsuser-guideplatform-consoleoperation-mgmthelm><span>Helm应用</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsuser-guideplatform-consoleoperation-mgmtlog-collect-li><a href=/web/zh/docs/user-guide/platform-console/operation-mgmt/log-collect/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsuser-guideplatform-consoleoperation-mgmtlog-collect><span>日志采集</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsuser-guideplatform-consoleoperation-mgmtaudit-li><a href=/web/zh/docs/user-guide/platform-console/operation-mgmt/audit/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsuser-guideplatform-consoleoperation-mgmtaudit><span>审计记录</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsuser-guideplatform-consoleoperation-mgmtpersistentevent-li><a href=/web/zh/docs/user-guide/platform-console/operation-mgmt/persistentevent/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsuser-guideplatform-consoleoperation-mgmtpersistentevent><span>事件持久化</span></a></li></ul></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-webzhdocsuser-guidebusiness-console-li><a href=/web/zh/docs/user-guide/business-console/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id=m-webzhdocsuser-guidebusiness-console><span>业务管理控制台</span></a><ul class="pr-md-3 ul-3"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-webzhdocsuser-guidebusiness-consoleworkload-mgmt-li><a href=/web/zh/docs/user-guide/business-console/workload-mgmt/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id=m-webzhdocsuser-guidebusiness-consoleworkload-mgmt><span>应用管理</span></a><ul class="pr-md-3 ul-4"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsuser-guidebusiness-consoleworkload-mgmtnamespace-li><a href=/web/zh/docs/user-guide/business-console/workload-mgmt/namespace/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsuser-guidebusiness-consoleworkload-mgmtnamespace><span>命名空间</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-webzhdocsuser-guidebusiness-consoleworkload-mgmtworkload-li><a href=/web/zh/docs/user-guide/business-console/workload-mgmt/workload/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id=m-webzhdocsuser-guidebusiness-consoleworkload-mgmtworkload><span>工作负载</span></a><ul class="pr-md-3 ul-5"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsuser-guidebusiness-consoleworkload-mgmtworkloaddevelopment-li><a href=/web/zh/docs/user-guide/business-console/workload-mgmt/workload/development/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsuser-guidebusiness-consoleworkload-mgmtworkloaddevelopment><span>Deployment</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsuser-guidebusiness-consoleworkload-mgmtworkloadstatefulset-li><a href=/web/zh/docs/user-guide/business-console/workload-mgmt/workload/statefulset/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsuser-guidebusiness-consoleworkload-mgmtworkloadstatefulset><span>StatefulSet</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsuser-guidebusiness-consoleworkload-mgmtworkloaddaomonset-li><a href=/web/zh/docs/user-guide/business-console/workload-mgmt/workload/daomonset/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsuser-guidebusiness-consoleworkload-mgmtworkloaddaomonset><span>DaomonSet</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsuser-guidebusiness-consoleworkload-mgmtworkloadjob-li><a href=/web/zh/docs/user-guide/business-console/workload-mgmt/workload/job/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsuser-guidebusiness-consoleworkload-mgmtworkloadjob><span>Job</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsuser-guidebusiness-consoleworkload-mgmtworkloadcronjob-li><a href=/web/zh/docs/user-guide/business-console/workload-mgmt/workload/cronjob/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsuser-guidebusiness-consoleworkload-mgmtworkloadcronjob><span>CronJob</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsuser-guidebusiness-consoleworkload-mgmtworkloadtapp-li><a href=/web/zh/docs/user-guide/business-console/workload-mgmt/workload/tapp/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsuser-guidebusiness-consoleworkload-mgmtworkloadtapp><span>TApp</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsuser-guidebusiness-consoleworkload-mgmtworkloadrequest-limits-li><a href=/web/zh/docs/user-guide/business-console/workload-mgmt/workload/request-limits/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsuser-guidebusiness-consoleworkload-mgmtworkloadrequest-limits><span>工作负载的请求与限制</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-webzhdocsuser-guidebusiness-consoleworkload-mgmtfu-wu-li><a href=/web/zh/docs/user-guide/business-console/workload-mgmt/fu-wu/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id=m-webzhdocsuser-guidebusiness-consoleworkload-mgmtfu-wu><span>服务</span></a><ul class="pr-md-3 ul-5"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsuser-guidebusiness-consoleworkload-mgmtfu-wuservice-li><a href=/web/zh/docs/user-guide/business-console/workload-mgmt/fu-wu/service/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsuser-guidebusiness-consoleworkload-mgmtfu-wuservice><span>Service</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsuser-guidebusiness-consoleworkload-mgmtfu-wuingress-li><a href=/web/zh/docs/user-guide/business-console/workload-mgmt/fu-wu/ingress/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsuser-guidebusiness-consoleworkload-mgmtfu-wuingress><span>Ingress</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-webzhdocsuser-guidebusiness-consoleworkload-mgmtpei-zhi-guan-li-li><a href=/web/zh/docs/user-guide/business-console/workload-mgmt/pei-zhi-guan-li/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id=m-webzhdocsuser-guidebusiness-consoleworkload-mgmtpei-zhi-guan-li><span>配置管理</span></a><ul class="pr-md-3 ul-5"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsuser-guidebusiness-consoleworkload-mgmtpei-zhi-guan-liconfigmap-li><a href=/web/zh/docs/user-guide/business-console/workload-mgmt/pei-zhi-guan-li/configmap/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsuser-guidebusiness-consoleworkload-mgmtpei-zhi-guan-liconfigmap><span>ConfigMap</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsuser-guidebusiness-consoleworkload-mgmtpei-zhi-guan-lisecret-li><a href=/web/zh/docs/user-guide/business-console/workload-mgmt/pei-zhi-guan-li/secret/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsuser-guidebusiness-consoleworkload-mgmtpei-zhi-guan-lisecret><span>Sercet</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-webzhdocsuser-guidebusiness-consoleworkload-mgmtcun-chu-li><a href=/web/zh/docs/user-guide/business-console/workload-mgmt/cun-chu/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id=m-webzhdocsuser-guidebusiness-consoleworkload-mgmtcun-chu><span>存储</span></a><ul class="pr-md-3 ul-5"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsuser-guidebusiness-consoleworkload-mgmtcun-chupv-he-pvc-li><a href=/web/zh/docs/user-guide/business-console/workload-mgmt/cun-chu/pv-he-pvc/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsuser-guidebusiness-consoleworkload-mgmtcun-chupv-he-pvc><span>PV和PVC</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsuser-guidebusiness-consoleworkload-mgmtcun-chustorageclass-li><a href=/web/zh/docs/user-guide/business-console/workload-mgmt/cun-chu/storageclass/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsuser-guidebusiness-consoleworkload-mgmtcun-chustorageclass><span>StorageClass</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsuser-guidebusiness-consoleworkload-mgmtshi-jian-li><a href=/web/zh/docs/user-guide/business-console/workload-mgmt/shi-jian/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsuser-guidebusiness-consoleworkload-mgmtshi-jian><span>事件</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsuser-guidebusiness-consoleworkload-mgmtlog-li><a href=/web/zh/docs/user-guide/business-console/workload-mgmt/log/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsuser-guidebusiness-consoleworkload-mgmtlog><span>日志</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsuser-guidebusiness-consolebusiness-mgmt-li><a href=/web/zh/docs/user-guide/business-console/business-mgmt/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsuser-guidebusiness-consolebusiness-mgmt><span>业务管理</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-webzhdocsuser-guidebusiness-consoleregistry-mgmt-li><a href=/web/zh/docs/user-guide/business-console/registry-mgmt/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id=m-webzhdocsuser-guidebusiness-consoleregistry-mgmt><span>组织资源</span></a><ul class="pr-md-3 ul-4"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsuser-guidebusiness-consoleregistry-mgmtrepo-mgmt-li><a href=/web/zh/docs/user-guide/business-console/registry-mgmt/repo-mgmt/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsuser-guidebusiness-consoleregistry-mgmtrepo-mgmt><span>镜像仓库管理</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsuser-guidebusiness-consoleregistry-mgmthelm-repo-li><a href=/web/zh/docs/user-guide/business-console/registry-mgmt/helm-repo/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsuser-guidebusiness-consoleregistry-mgmthelm-repo><span>Helm模板</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsuser-guidebusiness-consoleregistry-mgmtapikey-mgmt-li><a href=/web/zh/docs/user-guide/business-console/registry-mgmt/apikey-mgmt/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsuser-guidebusiness-consoleregistry-mgmtapikey-mgmt><span>访问凭证</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-webzhdocsuser-guidebusiness-consolemonitor-alert-li><a href=/web/zh/docs/user-guide/business-console/monitor-alert/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id=m-webzhdocsuser-guidebusiness-consolemonitor-alert><span>监控与告警</span></a><ul class="pr-md-3 ul-4"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsuser-guidebusiness-consolemonitor-alertalerts-li><a href=/web/zh/docs/user-guide/business-console/monitor-alert/alerts/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsuser-guidebusiness-consolemonitor-alertalerts><span>设置告警</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsuser-guidebusiness-consolemonitor-alertnotifier-li><a href=/web/zh/docs/user-guide/business-console/monitor-alert/notifier/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsuser-guidebusiness-consolemonitor-alertnotifier><span>通知设置</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-webzhdocsuser-guidebusiness-consoleoperation-mgmt-li><a href=/web/zh/docs/user-guide/business-console/operation-mgmt/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id=m-webzhdocsuser-guidebusiness-consoleoperation-mgmt><span>运维中心</span></a><ul class="pr-md-3 ul-4"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsuser-guidebusiness-consoleoperation-mgmthelm-li><a href=/web/zh/docs/user-guide/business-console/operation-mgmt/helm/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsuser-guidebusiness-consoleoperation-mgmthelm><span>Helm应用</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsuser-guidebusiness-consoleoperation-mgmtlog-collection-li><a href=/web/zh/docs/user-guide/business-console/operation-mgmt/log-collection/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsuser-guidebusiness-consoleoperation-mgmtlog-collection><span>日志采集</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsuser-guidebusiness-consolehelm-mgmt-li><a href=/web/zh/docs/user-guide/business-console/helm-mgmt/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsuser-guidebusiness-consolehelm-mgmt><span></span></a></li></ul></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-webzhdocskey-features-li><a href=/web/zh/docs/key-features/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id=m-webzhdocskey-features><span>特色功能</span></a><ul class="pr-md-3 ul-2"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocskey-featurestapp-li><a href=/web/zh/docs/key-features/tapp/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocskey-featurestapp><span>TAPP</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocskey-featuresgalaxy-li><a href=/web/zh/docs/key-features/galaxy/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocskey-featuresgalaxy><span>Galaxy</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocskey-featurescronhpa-li><a href=/web/zh/docs/key-features/cronhpa/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocskey-featurescronhpa><span>CronHPA</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocskey-featuresgpumanager-li><a href=/web/zh/docs/key-features/gpumanager/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocskey-featuresgpumanager><span>GPU-Manager说明</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocskey-featureslbcf-li><a href=/web/zh/docs/key-features/lbcf/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocskey-featureslbcf><span>LBCF说明</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-webzhdocsbest-practice-li><a href=/web/zh/docs/best-practice/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id=m-webzhdocsbest-practice><span>最佳实践</span></a><ul class="pr-md-3 ul-2"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsbest-practicek8s-upgrade-li><a href=/web/zh/docs/best-practice/k8s-upgrade/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsbest-practicek8s-upgrade><span>K8S 版本升级说明</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsbest-practicecustom-k8s-version-upgrade-li><a href=/web/zh/docs/best-practice/custom-k8s-version-upgrade/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsbest-practicecustom-k8s-version-upgrade><span>自定义k8s版本升级</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsbest-practiceprivate-environment-install-li><a href=/web/zh/docs/best-practice/private-environment-install/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsbest-practiceprivate-environment-install><span>wx 私有化部署最佳实践</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id=m-webzhdocsbest-practicestorage-practice-li><a href=/web/zh/docs/best-practice/storage-practice/ class="align-left pl-0 pr-2 active td-sidebar-link td-sidebar-link__page" id=m-webzhdocsbest-practicestorage-practice><span class=td-sidebar-nav-active-item>使用存储的实践</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsbest-practicejenkins-cicd-li><a href=/web/zh/docs/best-practice/jenkins-cicd/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsbest-practicejenkins-cicd><span>基于 Jenkins 的 CI/CD</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-webzhdocsdevelop-li><a href=/web/zh/docs/develop/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id=m-webzhdocsdevelop><span>开发指引</span></a><ul class="pr-md-3 ul-2"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsdevelopapi-li><a href=/web/zh/docs/develop/api/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsdevelopapi><span>API 使用指引</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-webzhdocsfaq-li><a href=/web/zh/docs/faq/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id=m-webzhdocsfaq><span>FAQ</span></a><ul class="pr-md-3 ul-2"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-webzhdocsfaqinstallation-li><a href=/web/zh/docs/faq/installation/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id=m-webzhdocsfaqinstallation><span>部署类</span></a><ul class="pr-md-3 ul-3"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsfaqinstallationfrequently-answer-li><a href=/web/zh/docs/faq/installation/frequently-answer/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsfaqinstallationfrequently-answer><span>常见报错解决方法</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsfaqinstallationresource-plan-li><a href=/web/zh/docs/faq/installation/resource-plan/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsfaqinstallationresource-plan><span>如何规划部署资源</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsfaqinstallationstorage-suggest-li><a href=/web/zh/docs/faq/installation/storage-suggest/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsfaqinstallationstorage-suggest><span></span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-webzhdocsfaqplatforms-li><a href=/web/zh/docs/faq/platforms/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id=m-webzhdocsfaqplatforms><span>平台类</span></a><ul class="pr-md-3 ul-3"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsfaqplatformsmetricsinfo-li><a href=/web/zh/docs/faq/platforms/metricsinfo/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsfaqplatformsmetricsinfo><span>监控告警指标列表</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsfaqplatformsplatform-questions-li><a href=/web/zh/docs/faq/platforms/platform-questions/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsfaqplatformsplatform-questions><span>平台使用常见问题</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsfaqplatformsfrequently-answers-li><a href=/web/zh/docs/faq/platforms/frequently-answers/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsfaqplatformsfrequently-answers><span></span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-webzhdocsfaqpermission-li><a href=/web/zh/docs/faq/permission/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id=m-webzhdocsfaqpermission><span>授权类</span></a><ul class="pr-md-3 ul-3"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsfaqpermissionldap-oidc-li><a href=/web/zh/docs/faq/permission/ldap-oidc/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsfaqpermissionldap-oidc><span>如何接入LDAP&OIDC</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsfaqpermissionbusiness-platform-li><a href=/web/zh/docs/faq/permission/business-platform/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsfaqpermissionbusiness-platform><span>业务管理、平台管理的区别</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsfaqpermissioncustom-policy-li><a href=/web/zh/docs/faq/permission/custom-policy/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsfaqpermissioncustom-policy><span>如何设置自定义策略</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsfaqpermissiondockerlogin-error-li><a href=/web/zh/docs/faq/permission/dockerlogin-error/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsfaqpermissiondockerlogin-error><span>Docker login 权限错误</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-webzhdocsfaqevents-li><a href=/web/zh/docs/faq/events/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id=m-webzhdocsfaqevents><span>事件类</span></a><ul class="pr-md-3 ul-3"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsfaqeventsfrequently-event-li><a href=/web/zh/docs/faq/events/frequently-event/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsfaqeventsfrequently-event><span>常见错误事件</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsfaqfunctionalcustom-metrics-li><a href=/web/zh/docs/faq/functional/custom-metrics/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsfaqfunctionalcustom-metrics><span></span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsfaqfunctionalldap-oidc-li><a href=/web/zh/docs/faq/functional/ldap-oidc/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsfaqfunctionalldap-oidc><span></span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsfaqfunctionallog-analysis-li><a href=/web/zh/docs/faq/functional/log-analysis/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsfaqfunctionallog-analysis><span></span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsfaqfunctionalreadme-li><a href=/web/zh/docs/faq/functional/readme/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsfaqfunctionalreadme><span></span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-webzhdocsrelease-li><a href=/web/zh/docs/release/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id=m-webzhdocsrelease><span>Release Notes</span></a><ul class="pr-md-3 ul-2"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsreleaserelease15-li><a href=/web/zh/docs/release/release1.5/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsreleaserelease15><span>1.5</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsreleaserelease14-li><a href=/web/zh/docs/release/release1.4/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsreleaserelease14><span>1.4</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webzhdocsreleaserelease13-li><a href=/web/zh/docs/release/release1.3/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id=m-webzhdocsreleaserelease13><span>1.3</span></a></li></ul></li></ul></li></ul></nav></div></div><div class="d-none d-xl-block col-xl-2 td-toc d-print-none"><div class="td-page-meta ml-2 pb-1 pt-2 mb-0"><a href=https://github.com/tkestack/web/edit/master/content/zh/docs/best-practice/storage-practice.md target=_blank><i class="fa fa-edit fa-fw"></i> 编辑此页</a>
<a href="https://github.com/tkestack/web/new/master/content/zh/docs/best-practice/storage-practice.md?filename=change-me.md&value=---%0Atitle%3A+%22Long+Page+Title%22%0AlinkTitle%3A+%22Short+Nav+Title%22%0Aweight%3A+100%0Adescription%3A+%3E-%0A+++++Page+description+for+heading+and+indexes.%0A---%0A%0A%23%23+Heading%0A%0AEdit+this+template+to+create+your+new+page.%0A%0A%2A+Give+it+a+good+name%2C+ending+in+%60.md%60+-+e.g.+%60getting-started.md%60%0A%2A+Edit+the+%22front+matter%22+section+at+the+top+of+the+page+%28weight+controls+how+its+ordered+amongst+other+pages+in+the+same+directory%3B+lowest+number+first%29.%0A%2A+Add+a+good+commit+message+at+the+bottom+of+the+page+%28%3C80+characters%3B+use+the+extended+description+field+for+more+detail%29.%0A%2A+Create+a+new+branch+so+you+can+preview+your+new+file+and+request+a+review+via+Pull+Request.%0A" target=_blank><i class="fa fa-edit fa-fw"></i> 添加子页面</a>
<a href="https://github.com/tkestack/web/issues/new?title=%e4%bd%bf%e7%94%a8%e5%ad%98%e5%82%a8%e7%9a%84%e5%ae%9e%e8%b7%b5" target=_blank><i class="fab fa-github fa-fw"></i> 提交文档问题</a>
<a id=print href=/web/zh/docs/best-practice/_print/><i class="fa fa-print fa-fw"></i> 整节打印</a></div><nav id=TableOfContents><ul><li><a href=#简介>简介</a></li><li><a href=#存储类型的选择>存储类型的选择</a></li><li><a href=#块存储参考实践>块存储参考实践</a><ul><li><a href=#部署块存储系统>部署块存储系统</a></li><li><a href=#使用块存储部署-elasticsearch>使用块存储部署 ElasticSearch</a></li><li><a href=#块存储小结>块存储小结</a></li></ul></li><li><a href=#文件存储参考实践>文件存储参考实践</a><ul><li><a href=#部署文件存储系统>部署文件存储系统</a></li><li><a href=#使用文件存储系统>使用文件存储系统</a></li><li><a href=#文件存储小结>文件存储小结</a></li></ul></li><li><a href=#对象存储参考实践>对象存储参考实践</a><ul><li><a href=#申请对象存储>申请对象存储</a></li><li><a href=#配置镜像仓库>配置镜像仓库</a></li><li><a href=#对象存储小结>对象存储小结</a></li></ul></li><li><a href=#总结>总结</a></li><li><a href=#参考链接>参考链接</a></li></ul></nav></div><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><nav aria-label=breadcrumb class="d-none d-md-block d-print-none"><ol class="breadcrumb spb-1"><li class=breadcrumb-item><a href=/web/zh/docs/>文档</a></li><li class=breadcrumb-item><a href=/web/zh/docs/best-practice/>最佳实践</a></li><li class="breadcrumb-item active" aria-current=page><a href=/web/zh/docs/best-practice/storage-practice/>使用存储的实践</a></li></ol></nav><div class=td-content><h1>使用存储的实践</h1><div class=lead>使用存储的实践</div><blockquote><p>本文以介绍如何在不同场景下选用合适的存储类型，并以实际的例子演示如何通过 TKEStack 部署和管理一个分布式存储服务，并以云原生的方式为容器化的应用提供高可用、高性能的存储服务。</p></blockquote><h2 id=简介>简介</h2><p>TKEStack 是腾讯开源的一款集易用性和扩展性于一身的企业级容器服务平台，帮助用户在私有云环境中敏捷、高效地构建和发布应用服务。TKEStack 本身不提供存储功能，但是可以通过集成云原生的存储应用，或者通过存储扩展组件的方式，对接用户的存储设施，扩展 TKEStack 平台的存储能力。</p><p>在本文中，通过 TKEStack 集成不同类型存储的介绍，帮助用户掌握云原生环境下存储的使用与管理，助力用户构建面向不同业务场景的容器云解决方案。</p><p><strong>本文所介绍的实践方案基于社区开源的存储方案，以及部分云提供商的存储服务方案</strong>，TKEStack 不提供对存储服务的质量保证。用户请根据自身实际情况，选择合适的存储方案，或者联系 TKEStack 官方社区、论坛寻求帮助。</p><p>TKEStack 支持通过 CSI 存储插件的方式对接外部存储系统，详情请参考 <a href=https://github.com/tkestack/tke/blob/master/hack/addon/readme/CSIOperator.md>TKEStack CSI Operator</a>。</p><h2 id=存储类型的选择>存储类型的选择</h2><p>存储类型大致有三种：块存储、文件存储及对象存储</p><ol><li><strong>块存储</strong>：是以块为单位，块存储实际上是管理到数据块一级，相当于直接管理硬盘的数据块。高性能、低时延，满足随机读写，使用时需要格式化为指定的文件系统后才能访问。</li><li><strong>文件存储</strong>：文件系统存储，文件系统是操作系统概念的一部份，支持 POSIX 的文件访问接口。优势是易管理、易共享，但由于采用上层协议, 因此开销大, 延时比块存储高。</li><li><strong>对象存储</strong>：提供 Key-Value（简称 K/V）方式的 RESTful 数据读写接口，并且常以网络服务的形式提供数据的访问。优点是高可用性、全托管、易扩展。</li></ol><p>上述几种存储类型各具特色，分别对应不同场景下的需求，例如：</p><ol><li>块存储具备高性能的读写，提供原始块设备操作能力，非常适合作为一些数据库系统的底层存储。</li><li>文件系统有着与操作系统一致的 POSIX 文件访问接口，能够方便的在特定范围内共享文件空间，典型的场景是 AI 学习、模型训练场景下对训练数据，模型和结果的存储。</li><li>对象存储是近年来兴起的一种新的存储方式，适用于分布式云计算场景下的应用业务的海量，高并发的互联网产品场景。</li></ol><p>更多存储系统的信息，请参考：<a href=https://en.wikipedia.org/wiki/Cloud_storage>wiki</a></p><h2 id=块存储参考实践>块存储参考实践</h2><p>本节将介绍如何通过 TKEStack 部署一套块存储系统，并演示如何在集群中使用该存储，在集群中部署 ElasticSearch 对外提供服务。</p><p>块存储系统有着较长的历史，基于传统 SAN 存储系统的方案已经非常成熟，但是 SAN 系统的价格较高，且可扩展性较差，难以满足大规模云计算系统下的使用需求。</p><p>但块存储本身具有的高带宽、低延迟，高吞吐率等优势，使它在云计算领域仍具有一席之地，典型的产品有 Ceph RBD，AWS EBS，腾讯云 CBS 等。</p><p>本节将以 Ceph RBD 为例，通过 <a href=https://rook.io/>Rook</a> 在 TKEStack 容器平台中部署 Ceph RBD 块存储集群，对业务提供块存储服务。</p><p>Rook 是一个自管理的分布式存储编排系统，可以为 Kubernetes 提供便利的存储解决方案。</p><p>Rook 支持在 K8S 中部署，主要由 Operator 和 Cluster 两部分组成：</p><ol><li><strong>Operator</strong>：Rook 的核心组件，自动启动存储集群，并监控存储守护进程，来确保存储集群的健康。</li><li><strong>Cluster</strong>：负责创建 CRD 对象，指定相关参数，包括 Ceph 镜像、元数据持久化位置、磁盘位置、dashboard 等等。</li></ol><h3 id=部署块存储系统>部署块存储系统</h3><p>Rook 支持通过 helm 或 yaml 文件的方式进行部署，本文直接使用官方的 yaml 文件部署 Rook Ceph 存储集群。</p><ol><li><p>登录 TKEStack 管理页面，进入集群管理页下，<strong>新建一个至少包括三台节点的集群</strong></p></li><li><p>登录至该集群的任意节点下，下载 Rook 项目，通过<a href=https://rook.io/docs/rook/v1.3/ceph-examples.html>官方例子</a>部署 Rook 集群</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text>git clone --single-branch --branch release-1.3 https://github.com/rook/rook.git
cd rook/cluster/examples/kubernetes/ceph
kubectl create -f common.yaml
kubectl create -f operator.yaml
kubectl create -f cluster.yaml
</code></pre></div></li></ol><p>文件中有几个地方要注意：</p><ul><li><strong>dataDirHostPath</strong>: 这个路径是会在宿主机上生成的，默认为 /var/lib/rook，保存的是 ceph 的相关的配置文件，再重新生成集群的时候要确保这个目录为空，否则 Ceph 监视器守护进程 <a href="https://docs.ceph.com/projects/ceph-deploy/en/latest/mon.html?highlight=ceph-mon">MON</a> 会无法启动</li><li><strong>useAllDevices</strong>: 使用节点上所有的设备，默认为 true，使用宿主机所有可用的磁盘</li><li><strong>useAllNodes</strong>：使用所有的 node 节点，默认为 true，使用用 k8s 集群内的所有 node 来搭建 Ceph</li><li><strong>network.hostNetwork</strong>: 使用宿主机的网络进行通讯，默认为 false，如果需要集群外挂载的场景可以开启这个选项</li></ul><p>部署完毕后，检查 Rook 组件工作状态：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text># kubectl get pod -n rook-ceph
NAME                                         READY   STATUS      RESTARTS   AGE
csi-rbdplugin-b52jx                          3/3     Running     3          9d
csi-rbdplugin-jpmgv                          3/3     Running     1          2d9h
csi-rbdplugin-provisioner-54cc7d5848-5fn8c   5/5     Running     0          2d8h
csi-rbdplugin-provisioner-54cc7d5848-w8dvk   5/5     Running     3          4d22h
csi-rbdplugin-z8dlc                          3/3     Running     1          2d9h
rook-ceph-mgr-a-6775645c-7qg5t               1/1     Running     1          4d7h
rook-ceph-mon-a-98664df75-jm72n              1/1     Running     0          2d9h
rook-ceph-operator-676bcb686f-2kwmz          1/1     Running     0          9d
rook-ceph-osd-0-6949755785-gjpxw             1/1     Running     0          2d9h
rook-ceph-osd-1-647fdc4d84-6lvw2             1/1     Running     0          11d
rook-ceph-osd-2-c6c6db577-gtcpz              1/1     Running     0          2d8h
rook-ceph-osd-prepare-172.21.64.15-xngl7     0/1     Completed   0          2d8h
rook-ceph-osd-prepare-172.21.64.36-gv2kw     0/1     Completed   0          28d
rook-ceph-osd-prepare-172.21.64.8-bhffr      0/1     Completed   0          2d8h
rook-ceph-tools-864695994d-b7nb8             1/1     Running     0          2d7h
rook-discover-28fqr                          1/1     Running     0          2d9h
rook-discover-m529m                          1/1     Running     0          9d
rook-discover-t2jzc                          1/1     Running     0          2d9h
</code></pre></div><p>至此一个完整的 Ceph RBD 集群就建立完毕，每台节点上都部署有 Ceph 对象存储守护进程 <a href=https://docs.ceph.com/en/latest/man/8/ceph-osd/>OSD</a>，默认使用节点下的 /var/lib/rook 目录存储数据。</p><h3 id=使用块存储部署-elasticsearch>使用块存储部署 ElasticSearch</h3><ol><li><p>创建 Ceph pool，创建 StorageClass</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text># cat storageclass.yaml
---                                                                                                                                                                                                                                
apiVersion: ceph.rook.io/v1                                                                                           
kind: CephBlockPool                                                                                                   
metadata:                                                                                                             
  name: replicapool                                                                                                  
  namespace: rook-ceph                                                                                                
spec:                                                                                                                 
  failureDomain: host                                                                                                 
  replicated:                                                                                                        
    size: 1        # 池中数据的副本数                                                                                     
---                                                                                                                   
apiVersion: storage.k8s.io/v1                                                                                         
kind: StorageClass                                                                                                    
metadata:                                                                                                             
  name: global-storageclass                                                                                           
provisioner: rook-ceph.rbd.csi.ceph.com                                                                               
parameters:                                                                                                           
  # clusterID is the namespace where the rook cluster is running                                                      
  # If you change this namespace, also change the namespace below where the secret namespaces are defined             
  clusterID: rook-ceph                                                                                               

  # Ceph pool into which the RBD image shall be created                                                               
  pool: replicapool                                                                                                   

  # RBD image format. Defaults to &#34;2&#34;.                                                                                
  imageFormat: \&#34;2\&#34;                                                                                                  

  # RBD image features. Available for imageFormat: &#34;2&#34;. CSI RBD currently supports only layering feature.             
  imageFeatures: layering                                                                                             

  # The secrets contain Ceph admin credentials. These are generated automatically by the operator                     
  # in the same namespace as the cluster.                                                                             
  csi.storage.k8s.io/provisioner-secret-name: rook-csi-rbd-provisioner                                                
  csi.storage.k8s.io/provisioner-secret-namespace: rook-ceph                                                          
  csi.storage.k8s.io/node-stage-secret-name: rook-csi-rbd-node                                                        
  csi.storage.k8s.io/node-stage-secret-namespace: rook-ceph                                                          
  # Specify the filesystem type of the volume. If not specified, csi-provisioner                                      
  # will set default as ext4.                                                                                         
  csi.storage.k8s.io/fstype: ext4                                                                                    
# uncomment the following to use rbd-nbd as mounter on supported nodes                                                
#mounter: rbd-nbd                                                                                                     
reclaimPolicy: Delete                                              
</code></pre></div></li><li><p>通过 StorageClass 动态创建 PVC，检查 PVC 能够正确的创建并绑定</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text># cat pvc.yaml
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: rbd-pvc
spec:
  accessModes:
  - ReadWriteOnce
  resources:
    requests:
      storage: 1Gi
  storageClassName: global-storageclass
# kubectl get pvc
NAME      STATUS   VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS          AGE
rbd-pvc   Bound    pvc-f9703e0d-9887-4bf2-8e31-1c3103a6ce2f   1Gi        RWO            global-storageclass   2s
</code></pre></div></li><li><p>创建 ElasticSearch 应用，通过 StorageClass 动态申请块存储，使用 Ceph RBD 集群作为 ElasticSearch 的后端存储设备</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text># cat es.yaml
apiVersion: v1
kind: Namespace
metadata:
  name: efk   

---
apiVersion: apps/v1
kind: StatefulSet
metadata:
  name: elasticsearch-master
  namespace: efk
  labels:
    app: elasticsearch-master
spec:
  podManagementPolicy: Parallel
  serviceName: elasticsearch-master
  replicas: 3
  selector:
    matchLabels:
      app: elasticsearch-master
  template:
    metadata:
      labels:
        app: elasticsearch-master
    spec:
      affinity:
        podAntiAffinity:
          preferredDuringSchedulingIgnoredDuringExecution:
          - weight: 1
            podAffinityTerm:
              topologyKey: kubernetes.io/hostname
              labelSelector:
                matchLabels:
                  app: &#34;elasticsearch-master&#34;
      initContainers:
      # see https://www.elastic.co/guide/en/elasticsearch/reference/current/vm-max-map-count.html
      # and https://www.elastic.co/guide/en/elasticsearch/reference/current/setup-configuration-memory.html#mlockall
      - name: &#34;sysctl&#34;
        image: &#34;busybox&#34;
        imagePullPolicy: &#34;Always&#34;
        command: [&#34;sysctl&#34;, &#34;-w&#34;, &#34;vm.max_map_count=262144&#34;]
        securityContext:
          allowPrivilegeEscalation: true
          privileged: true
      containers:
      - name: elasticsearch
        env:
        - name: cluster.name
          value: elasticsearch-cluster
        - name: discovery.zen.ping.unicast.hosts
          value: elasticsearch-master
        - name: discovery.zen.minimum_master_nodes
          value: &#34;2&#34;
        - name: KUBERNETES_NAMESPACE
          valueFrom:
            fieldRef:
              fieldPath: metadata.namespace
        # node roles, default to all true
        # - name: NODE_MASTER
        #   value: &#34;true&#34;
        # - name: NODE_DATA
        #   value: &#34;true&#34;
        # - name: NODE_INGEST
        #   value: &#34;true&#34;
        - name: PROCESSORS
          valueFrom:
            resourceFieldRef:
              resource: limits.cpu
        - name: ES_JAVA_OPTS
          value: &#34;-Djava.net.preferIPv4Stack=true -Xmx1g -Xms1g&#34;
        resources:
        readinessProbe:
          httpGet:
            path: /_cluster/health?local=true
            port: 9200
          initialDelaySeconds: 5
        image: docker.elastic.co/elasticsearch/elasticsearch-oss:6.2.4
        imagePullPolicy: IfNotPresent
        ports:
        - containerPort: 9300
          name: transport
        - containerPort: 9200
          name: http
        volumeMounts:
        - mountPath: /usr/share/elasticsearch/data
          name: elasticsearch-master
      volumes:
      terminationGracePeriodSeconds: 120
  volumeClaimTemplates:
  - metadata:
      name: elasticsearch-master
    spec:
      accessModes:
      - ReadWriteOnce
      resources:
        requests:
          storage: 20Gi
      storageClassName: global-storageclass
      volumeMode: Filesystem

---

apiVersion: v1
kind: Service
metadata:
  name: elasticsearch-master
  namespace: efk
  labels:
    app: elasticsearch-master
spec:
  type: ClusterIP
  ports:
    - name: http
      port: 9200
      protocol: TCP
      targetPort: 9200
    - name: transport
      port: 9300
      protocol: TCP
      targetPort: 9300
  selector:
    app: elasticsearch-master
</code></pre></div></li><li><p>等待 ElasticSearch 实例建立完成，磁盘被正确的挂载</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text># kubectl get pod -n efk
NAME                          READY   STATUS    RESTARTS   AGE
elasticsearch-master-0        1/1     Running   0          2d19h
elasticsearch-master-1        1/1     Running   0          2d19h
elasticsearch-master-2        1/1     Running   0          2d19h
# kubectl get pvc -n efk
NAME                                          STATUS   VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS          AGE
elasticsearch-master-elasticsearch-master-0   Bound    pvc-405fc7b2-82eb-4eda-a6b7-e54d1713cbeb   20Gi       RWO            global-storageclass   41d
elasticsearch-master-elasticsearch-master-1   Bound    pvc-6e89f8d5-4702-4b2f-81c2-f9f89a249b0a   20Gi       RWO            global-storageclass   41d
elasticsearch-master-elasticsearch-master-2   Bound    pvc-16c9c1ab-4c77-463f-b5f0-fc643ced2fce   20Gi       RWO            global-storageclass   41d
</code></pre></div></li></ol><h3 id=块存储小结>块存储小结</h3><p>按照本节指引，用户可以在 TKEStack 平台下创建出一个 Ceph RBD 块存储集群，并通过 StorageClass 方式动态的申请和使用块存储资源，并能够搭建出 ElasticSearch 应用对外提供服务。</p><p>由于块存储的特性，在 K8S 场景下仅支持 ReadWriteOnce 和 ReadOnlyMany 访问方式，并且这里的访问方式是节点级别的，例如 ReadOnlyMany, 只能被同一节点的多个 Pod 挂载，如果从多个节点挂载，系统会报 Multi-Attach 错误。</p><p>因此在 K8S 使用块存储场景上，基本上一个 Pod 挂载一个 PVC，典型的应用场景是 Redis，ElasticSearch，Mysql数据库等。</p><p>如果用户已存在块存储设备，TKEStack 支持通过 CSI 插件对接已有的存储设备，详情请参考 <a href=https://github.com/tkestack/tke/blob/master/hack/addon/readme/CSIOperator.md>TKEStack CSI Operator</a>。</p><h2 id=文件存储参考实践>文件存储参考实践</h2><p>本节将介绍如何在 TKEStack 中部署一套文件存储系统，并演示如何在平台中使用该存储。</p><p>本节以 ChubaoFS (储宝文件系统)为例，通过在集群中部署和集成 ChubaoFS，向用户展示如何在 TKEStack 中使能文件存储功能。</p><p>ChubaoFS (储宝文件系统)是为大规模容器平台设计的分布式文件系统，详情请参考<a href=https://chubaofs.readthedocs.io/zh_CN/latest/overview.html#>ChubaoFS 官方文档</a>。</p><p>ChubaoFS 支持在 k8s 集群中部署，通过 Helm 的方式在集群中安装元数据子系统，数据子系统和资源管理节点等，对外提供文件存储服务。</p><h3 id=部署文件存储系统>部署文件存储系统</h3><ol><li><p>登录 TKEStack 管理页面，进入集群管理页下，新建<strong>一个至少包括五台节点的集群</strong>，并为该集群使能"Helm 应用管理"扩展组件</p></li><li><p>设置节点标签，ChubaoFS 将根据标签分配不同的组件到节点上运行</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text>kubectl label node &lt;nodename&gt; chuabaofs-master=enabled
kubectl label node &lt;nodename&gt; chuabaofs-metanode=enabled
kubectl label node &lt;nodename&gt; chuabaofs-datanode=enabled
</code></pre></div><blockquote><p>注：至少保证有3台 <a href=https://chubaofs.readthedocs.io/zh_CN/latest/user-guide/master.html>Master</a>，3台 <a href=https://chubaofs.readthedocs.io/zh_CN/latest/user-guide/metanode.html>Metanode</a>，5台 <a href=https://chubaofs.readthedocs.io/zh_CN/latest/user-guide/datanode.html>Datanode</a></p></blockquote></li><li><p>登录到该集群下的一台节点上，下载 ChubaoFS 应用的 <a href=https://github.com/chubaofs/chubaofs-helm>chart 包</a>，根据环境修改 values.yaml 文件中的参数（本文使用默认值）</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text># ls chubaofs
Chart.yaml  config  README.md  templates  values.yaml
</code></pre></div></li><li><p>本地安装 Helm 客户端, 更多可查看 <a href=https://helm.sh/docs/intro/quickstart/>安装 Helm</a>，使用 Helm 客户端安装 ChubaoFS ，等待安装完成</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text># helm install --name chubao ./chubaofs
# ./helm status chubao
</code></pre></div></li><li><p>安装完成后，检查所有组件工作正常</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text># kubectl get pod -n chubaofs
NAME                          READY   STATUS    RESTARTS   AGE
client-c5c5b99f6-qqf7h        1/1     Running   0          17h
consul-6d67d5c55-jgw9z        1/1     Running   0          18h
datanode-9vqvm                1/1     Running   0          18h
datanode-bgffs                1/1     Running   0          18h
datanode-dtckp                1/1     Running   0          18h
datanode-jtrzj                1/1     Running   0          18h
datanode-p5nmc                1/1     Running   0          18h
grafana-7cc9db7489-st27v      1/1     Running   0          18h
master-0                      1/1     Running   0          18h
master-1                      1/1     Running   0          18h
master-2                      1/1     Running   0          17h
metanode-ghrpm                1/1     Running   0          18h
metanode-gn5kl                1/1     Running   0          18h
metanode-wqzwp                1/1     Running   0          18h
prometheus-77d5d6cb7f-xs748   1/1     Running   0          18h
kubectl get svc -n chubaofs
NAME                 TYPE        CLUSTER-IP        EXTERNAL-IP   PORT(S)          AGE
consul-service       NodePort    192.168.255.116   &lt;none&gt;        8500:30831/TCP   20h
grafana-service      ClusterIP   192.168.255.16    &lt;none&gt;        3000/TCP         20h
master-service       NodePort    192.168.255.104   &lt;none&gt;        8080:32102/TCP   20h
prometheus-service   ClusterIP   192.168.255.4     &lt;none&gt;        9090/TCP         20h
</code></pre></div></li></ol><h3 id=使用文件存储系统>使用文件存储系统</h3><ol><li><p>参考 <a href=https://chubaofs.readthedocs.io/zh_CN/latest/user-guide/csi-driver.html#kubernetes-v1-15>ChubaoFS CSI 文档</a>，在想要使用文件存储的集群上部署 ChubaoFS CSI Driver 插件</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text># git clone https://github.com/chubaofs/chubaofs-csi.git
# cd chubaofs-csi
# kubectl apply -f deploy/csi-controller-deployment.yaml
# kubectl apply -f deploy/csi-node-daemonset.yaml
</code></pre></div></li><li><p>创建 StorageClass，指定 master 和 consul 的访问地址</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text>kind: StorageClass
apiVersion: storage.k8s.io/v1
metadata:
  name: chubaofs-sc
provisioner: csi.chubaofs.com
reclaimPolicy: Delete
parameters:
  masterAddr: &#34;172.21.64.14:32102&#34;	# Master地址
  owner: &#34;csiuser&#34;
  # cannot set profPort and exporterPort value, reason: a node may be run many cfs-client
  #  profPort: &#34;10094&#34;
  #  exporterPort: &#34;9513&#34;
  consulAddr: &#34;172.21.64.14:30831&#34;	# 监控系统的地址
  logLevel: &#34;debug&#34;
</code></pre></div></li><li><p>通过 StorageClass 创建 PVC，创建使用 PVC 的应用</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text># cat pvc.yaml
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: chubaofs-pvc
spec:
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: 1Gi
  storageClassName: chubaofs-sc
# cat deployment.yaml 
apiVersion: apps/v1
kind: Deployment
metadata:
  name: cfs-csi-demo
  namespace: default
spec:
  replicas: 1
  selector:
    matchLabels:
      app: cfs-csi-demo-pod
  template:
    metadata:
      labels:
        app: cfs-csi-demo-pod
    spec:
      containers:
        - name: chubaofs-csi-demo
          image: nginx:1.17.9
          imagePullPolicy: &#34;IfNotPresent&#34;
          ports:
            - containerPort: 80
              name: &#34;http-server&#34;
          volumeMounts:
            - mountPath: &#34;/usr/share/nginx/html&#34;
              name: mypvc
      volumes:
        - name: mypvc
          persistentVolumeClaim:
            claimName: chubaofs-pvc
</code></pre></div></li></ol><h3 id=文件存储小结>文件存储小结</h3><p>通过上面的例子，用户可以创建一个 ChubaoFS 的文件系统集群，并通过 ChubaoFS CSI Driver 插件，将文件存储映射为 K8S 的资源（PVC，StorageClass）。</p><p>由于文件存储的支持多读多写的特性，使得用户在有共享存储需求的场景下，如 AI 计算、模型训练等，通过 TKEStack + ChubaoFS 的方案，快速构建出容器产品和解决方案。</p><p>如果用户已存在文件存储设备，TKEStack支持通过 CSI 插件对接已有的存储设备，详情请参考 <a href=https://github.com/tkestack/tke/blob/master/hack/addon/readme/CSIOperator.md>TKEStack CSI Operator</a>。</p><h2 id=对象存储参考实践>对象存储参考实践</h2><p>本节介绍最后一个存储类型——对象存储， 对象存储的访问接口基本都是 RESTful API，用户可通过网络存储和查看数据，具备高扩展性、低成本、可靠和安全特性。</p><p>常见的对象存储有 Ceph 的 RADOS、OpenStack 的 Swift、AWS S3 等，并且各大主流的云提供商的都有提供对象存储服务，方便互联网用户快速地接入，实现了海量数据访问和管理。</p><p>本节将在一个公有云的环境下，申请云提供商提供的对象存储，通过标准的 S3 接口对接 TKEStack 的镜像仓库的服务，这样就可以将 TKEStack 平台下的镜像存储在对象存储中，方便扩展和管理。</p><h3 id=申请对象存储>申请对象存储</h3><p>以腾讯云为例，登录控制台后进入对象存储产品中心，在存储桶列表页面下创建一个新的存储桶，创建成功后记录下访问域名，所属地域，访问 ID 和密钥等。</p><p>注：访问 ID 和密钥信息请参考<a href=https://cloud.tencent.com/document/product/436/31315>腾讯云对象存储文档</a>，更多关于对象存储的信息访问<a href=https://cloud.tencent.com/document/product/436/6222>官网</a>。</p><h3 id=配置镜像仓库>配置镜像仓库</h3><p>TKEStack 提供镜像仓库功能，为用户提供容器镜像的上传，下载和管理功能，并且镜像仓库中保存平台所需的所有镜像，满足各种离线环境的需求。</p><p>如果按照默认方式安装配置，TKEStack 的镜像仓库默认使用 Global 集群下 Master 主机上的存储资源，该种方式占用了有限的主机资源，且不方便进行扩展和迁移，有必要对镜像仓库模块重新配置，使其对接对象存储，方便扩展。</p><ol><li><p>登录 TKEStack 管理界面，进入 Global 集群<a href=https://github.com/tkestack/tke/blob/master/docs/guide/zh-CN/products/business-control-pannel/application/configurations/ConfigMap.md>配置管理</a>，找到 tke 命名空间下的 tke-registry-api 配置（configmap），修改 <code>storage</code> 字段如下</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text>  tke-registry-config.yaml: |
    apiVersion: registry.config.tkestack.io/v1
    kind: RegistryConfiguration
    storage:
#      fileSystem:
#        rootDirectory: /storage
      s3:
        bucket: xxxxxxxxxxxxx
        region: ap-beijing
        accessKey: xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
        secretKey: xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
        secure: false
        regionEndpoint: https://xxxxxxxxxxxxxx.cos.ap-beijing.myqcloud.com
</code></pre></div></li><li><p>修改完成后，重启 tke 命名空间下的 tke-registry-api 的 pod，使配置生效，等待重启后 pod 恢复</p></li><li><p>此时镜像仓库已使用基于 S3 接口的对象存储，用户可以向该仓库推送或下载镜像，验证功能</p></li></ol><blockquote><p>注意：</p><ul><li>由于更换了底层存储，重启后的镜像仓库中没有镜像，需要用户提前将原仓库中的所有镜像备份后，重新恢复至新的镜像仓库中</li><li>也可以在安装 TKEStack 平台时，为镜像仓库，以及监控存储配置对象存储服务，免去后期转移镜像和存储的操作，关于如何在安装时指定存储服务，详见<a href=https://github.com/tkestack/tke/blob/master/docs/user/cluster/ha.md>高可用部署相关文章</a></li></ul></blockquote><h3 id=对象存储小结>对象存储小结</h3><p>本节展示如果通过云提供商提供的对象存储服务，增强 TKEStack 的镜像仓库服务。在实际场景中，用户根据自身情况，选择合适的公有云上服务。</p><p>本文前面介绍的 Rook Ceph，ChubaoFS 等都支持对象存储服务，用户也可自行搭建本地的对象存储集群，详细指引参考对应产品的官网。</p><h2 id=总结>总结</h2><p>综上所述，TKEStack 平台能够通过各种云原生及扩展组件的方式，对接和集成不同种类的存储服务，满足各类应用场景的需求。后续 TKEStack 还会继续增强在存储方面的功能，不断完善操作体验，使得容器平台存储功能具备易于上手，种类丰富，灵活扩展的能力。</p><h2 id=参考链接>参考链接</h2><ol><li><a href=https://github.com/tkestack/tke>https://github.com/tkestack/tke</a></li><li><a href=https://www.zhihu.com/question/21536660>https://www.zhihu.com/question/21536660</a></li><li><a href=https://rook.io/>https://rook.io/</a></li><li><a href=https://github.com/chubaofs/chubaofs>https://github.com/chubaofs/chubaofs</a></li><li><a href=https://cloud.tencent.com/document/product/436/6222>https://cloud.tencent.com/document/product/436/6222</a></li></ol><div class="text-muted mt-5 pt-3 border-top">最后修改
March 25, 2022
: <a href=https://github.com/tkestack/web/commit/5eed232c8ac455e3d0af5bc01b098479818be943>Merge pull request #42 from wl-chen/chart-installer-fix (5eed232)</a></div></div></main></div></div><footer class="bg-dark py-5 row d-print-none"><div class="container-fluid mx-sm-5"><div class=row><div class="col-6 col-sm-4 text-xs-center order-sm-2"></div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank rel=noopener href=https://github.com/tkestack/tke aria-label=GitHub><i class="fab fa-github"></i></a></li></ul></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2"><small class=text-white>&copy; 2022 The TKEStack Authors All Rights Reserved</small></div></div></div></footer></div><script src=https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js integrity=sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js integrity=sha384-+YQ4JLhjyBLPDQt//I+STsc9iw4uQqACwlvpslubQzn4u2UU2UFM80nGisd026JF crossorigin=anonymous></script><script src=/web/js/main.min.1911ee3ae98d7d6df3807cd00d8e31ae7d1c08ee0f0bb587529b0483da4e5464.js integrity="sha256-GRHuOumNfW3zgHzQDY4xrn0cCO4PC7WHUpsEg9pOVGQ=" crossorigin=anonymous></script></body></html>